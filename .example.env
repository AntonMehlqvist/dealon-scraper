# --- CORE/RUNTIME MODE ---

RUN_MODE=full               # (full|delta|refresh) - select main operation mode
PRODUCTS_LIMIT=500          # Max products per site/run (0 = no limit)
OUT_DIR_BASE=out            # Output directory for data/snapshots
PROGRESS_EVERY=100          # Print progress every N products
SNAPSHOT_ONLY_TOUCHED=true  # If true, only snapshot products actually scraped in this run
DELTA_GRACE_SECONDS=120     # Delta operation: grace period in seconds for changed products
REFRESH_TTL_DAYS=30         # Refresh operation: TTL (days) for recheck

PDP_LOG=0                   # Set to 1 to log PDP extraction, 0 for silent
WARN_SAMPLE_EVERY=200       # Show warning every N samples

TRACK_HISTORY=true           # Enable history and price tracking
PRICE_HISTORY_FIELDS=price,originalPrice,inStock # Comma-separated fields to track in price history

# --- DRIZZLE / DATABASE ---

DB_URL=postgresql://user:password@localhost:5432/dbname  # Used by Drizzle/Postgres ORM

# --- ENTRY/SITE/SCRAPER CONFIG ---
SITE=apoteket               # Key for which site to run

# --- START, DISCOVERY, SCRAPER LIMITS ---
START_URL=https://www.apoteket.se/kategori/
SEED_URLS=
DISCOVER_MAX_PAGES=200
DISCOVER_MAX_DEPTH=3
DISCOVER_MAX_CATEGORIES=999
MAX_PAGES=0

# --- PARALLELISM/CONCURRENCY/DELAY ---
MAX_PAGE_CONCURRENCY=2
MAX_PRODUCT_CONCURRENCY=16
MIN_DELAY_MS=40
MAX_DELAY_MS=120
HOST_MAX_NAV_RPS=3
HOST_NAV_BURST=6
PDP_RETRIES=1

# --- PAGINATION ---
PAGINATION=auto
LOAD_MORE_MAX_CLICKS=12
LOAD_MORE_WAIT_MS=1500
LOAD_MORE_NEW_ITEMS_SELECTOR=a[href*="/produkt/"]
SCROLL_BEFORE_CLICK=true
LOAD_MORE_SCROLL_AFTER_CLICK=true

# --- HEADLESS/NAV/CACHE ---
HEADLESS=true
BLOCK_MEDIA=true
NAV_WAIT_LISTING=domcontentloaded
NAV_WAIT_PDP=domcontentloaded
READINESS_TIMEOUT_MS_PDP=7000

# --- OUTPUT & DEBUG ---
DEBUG_SAVE_HTML=false
STORAGE_STATE_PATH=storage/{site}-state.json

# --- ADVANCED/EXPERT/OPTIONAL ---
APOHEM_CHUNK_SIZE=1200          # Only for chunked Apohem runner/batching
SEED_FILE=                      # Path to seed file for chunked runs
SEED_ONLY=false                 # Only use seed URLs if true (bool: true/1)
EXTRA_SITEMAP_URLS=             # For extra discovery on special cases
SNAPSHOT_DB_PATH=state/data.sqlite  # Path to snapshot database
